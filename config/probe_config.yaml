dataset:
  name: "CzechLynx_v2" # WildlifeReID-10k | CzechLynx_v2
  animal: "CzechLynx" # LeopardID2022 | ReunionTurtles| CzechLynx
  root: "/shared/sets/datasets/vision/czechlynx/${dataset.name}"
  metadata_file: "CzechLynxDataset-Metadata-Real.csv" # metadata/metadata_${dataset.animal}.csv | CzechLynxDataset-Metadata-Real.csv
  label_col: "unique_name" # identity | unique_name
  mask_col: "mask"
  no_background: false # false | true
  split_col: "split-time_closed" # split | split-time_closed
  database_split_value: "train"
  query_split_value: "test"
  calibration_size: 100

model:
  type: "megadescriptor" # megadescriptor | dinov2 | dinov3
  mode: "pretrained"  # pretrained | finetuned
  device: "auto"     # auto | cpu | cuda
  batch_size: 32
  num_workers: 8
  checkpoint:
    path: null
    from_latest_results: true
    results_dir: "results"
    filename: "checkpoint-final.pth"

benchmark:
  method: "cosine"   # cosine | wildfusion | local_lightglue | linear_probe | efficient_probe | rdd
  top_k: [1, 5, 10]
  compute_map: true
  seed: 0
  deterministic: false
  cache:
    enabled: true
    dir: "/shared/results/common/kargin/lynx/results/${dataset.name}/${dataset.animal}/cache/features"
    format: "pt"     # pt | npz
  methods:
    cosine: {}
    wildfusion:
      B: 10
      deep_batch_size: 16
      deep_num_workers: 4
      local_batch_size: 16
    local_lightglue:
      B: 10
      local_batch_size: 16
    linear_probe:
      train_mode: "classifier"  # all | partial | classifier (frozen backbone)
      epochs: 50
      log_every: 1
      batch_size: 64
      num_workers: 8
      accumulation_steps: 1
      optimizer: "sgd"          # sgd | adam | adamw
      lr: 0.001
      momentum: 0.9
      weight_decay: 0.0001
      eta_min_scale: 1e-3
      eval_batch_size: 128
      eval_num_workers: 8
      resume_checkpoint: null
      save_checkpoint: false
      save_every: 1
      final_checkpoint_name: "linear_probe_final.pth"
      partial_rules:
        default: ["layers.3", "norm"]
        megadescriptor: ["layers.3", "norm"]
        lynx_megadescriptorV3: ["layers.3", "norm"]
        lynx_megadescriptorV4: ["layers.3", "norm"]
    efficient_probe:
      train_mode: "classifier"  # all | partial | classifier (frozen backbone)
      epochs: 50
      log_every: 1
      batch_size: 64
      num_workers: 8
      accumulation_steps: 1
      optimizer: "sgd"          # sgd | adam | adamw
      lr: 0.001
      momentum: 0.9
      weight_decay: 0.0001
      eta_min_scale: 1e-3
      dropout_rate: 0.0
      num_queries: 4
      d_out: 2
      eval_batch_size: 128
      eval_num_workers: 8
      resume_checkpoint: null
      save_checkpoint: false
      save_every: 1
      final_checkpoint_name: "efficient_probe_final.pth"
      partial_rules:
        default: ["layers.3", "norm"]
        dinov2: ["encoder.layer.11", "layernorm"]
        dinov3: ["encoder.layer.11", "layernorm"]
    rdd:
      repo_dir: "/home/kargin/Projects/repositories/rdd"
      config_path: "/home/kargin/Projects/repositories/rdd/configs/default.yaml"
      weights: "/home/kargin/Projects/repositories/rdd/weights/RDD-v2.pth"
      cache_dir: "/shared/results/common/kargin/lynx/results/${dataset.name}/${dataset.animal}/cache/rdd"
      device: "auto"        # auto | cpu | cuda
      path_col: "path"
      resize_max: 448
      top_k: 512
      stage_a_method: "cosine"   # cosine | wildfusion | local_lightglue | linear_probe | efficient_probe
      candidate_k: 100

visualization:
  enabled: false
  dir: "visualizations"
  num_examples: 16
  rdd_max_matches: 20
  attention_num_examples: 16
  attention_average_queries: true
  top_k: 3

output:
  run_dir: "benchmark_runs"
  csv_path: "benchmark_runs/benchmark_results.csv"

wandb:
  enabled: false
  project: "explainable-reid"
  entity: null
  group: null
  tags: []
  name: null
