dataset:
  root: "/shared/sets/datasets/vision/czechlynx/CzechLynx_v2"
  metadata_file: "CzechLynxDataset-Metadata-Real.csv"
  label_col: "unique_name"
  mask_col: "mask"
  no_background: false
  split_col: "split-time_closed"
  database_split_value: "train"
  query_split_value: "test"
  calibration_size: 100

model:
  type: "dinov2" # megadescriptor | dinov2 | dinov3
  mode: "pretrained"  # pretrained | finetuned
  device: "auto"     # auto | cpu | cuda
  batch_size: 32
  num_workers: 8
  checkpoint:
    path: null
    from_latest_results: true
    results_dir: "results"
    filename: "checkpoint-final.pth"

benchmark:
  method: "linear_probe"   # cosine | wildfusion | local_lightglue | linear_probe
  top_k: [1, 5, 10]
  compute_map: true
  seed: 0
  deterministic: false
  cache:
    enabled: true
    dir: "/shared/results/common/kargin/lynx/results/CzechLynx/cache/features"
    format: "pt"     # pt | npz
  methods:
    cosine: {}
    wildfusion:
      B: 10
      deep_batch_size: 16
      deep_num_workers: 4
      local_batch_size: 16
    local_lightglue:
      B: 10
      local_batch_size: 16
    linear_probe:
      train_mode: "classifier"  # all | partial | classifier (frozen backbone)
      epochs: 10
      log_every: 1
      batch_size: 64
      num_workers: 8
      accumulation_steps: 1
      optimizer: "sgd"          # sgd | adam | adamw
      lr: 0.001
      momentum: 0.9
      weight_decay: 0.0001
      eta_min_scale: 1e-3
      eval_batch_size: 128
      eval_num_workers: 8
      resume_checkpoint: null
      save_checkpoint: false
      save_every: 1
      final_checkpoint_name: "linear_probe_final.pth"
      partial_rules:
        default: ["layers.3", "norm"]
        megadescriptor: ["layers.3", "norm"]
        lynx_megadescriptorV3: ["layers.3", "norm"]
        lynx_megadescriptorV4: ["layers.3", "norm"]

visualization:
  enabled: false
  dir: "visualizations"
  num_examples: 8
  top_k: 3

output:
  run_dir: "benchmark_runs"
  csv_path: "benchmark_runs/benchmark_results.csv"

wandb:
  enabled: false
  project: "explainable-reid"
  entity: null
  group: null
  tags: []
  name: null
